<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ë§ˆì„ ì•ˆë‚´ë„ ë…ì„œí™œë™ í™œë™ì§€ (6ê°œ í™œë™ + í° ê¸€ì”¨ ëª¨ë“œ + ê·¸ë¦¼ í¬ê²Œ + ì—…ë¡œë“œ/ë¶™ì—¬ë„£ê¸°)</title>
  <style>
    :root{
      --ink:#111827;
      --muted:#6b7280;
      --line:#e5e7eb;
      --bg:#f8fafc;
      --card:#ffffff;
      --soft:#f3f4f6;
      --ok:#16a34a;
      --warn:#f59e0b;

      /* í° ê¸€ì”¨ ëª¨ë“œ(ê¸°ë³¸: ë³´í†µ) */
      --fs-body: 16px;
      --lh-body: 1.55;

      --fs-h1: 20px;
      --fs-sub: 13px;

      --fs-h2: 17px;
      --fs-hint: 13px;

      --fs-pill: 12px;
      --fs-q: 16px;

      --fs-input: 14px;
      --pad-input-y: 10px;
      --pad-input-x: 12px;
      --ta-minh: 82px;

      --fs-choice: 14px;
      --pad-choice-y: 9px;
      --pad-choice-x: 11px;
      --radio-size: 16px;

      --badge-size: 34px;
      --badge-radius: 10px;
      --badge-font: 16px;

      --token-font: 14px;
      --token-pad-y: 8px;
      --token-pad-x: 10px;

      /* âœ… ìº”ë²„ìŠ¤ í¬ê¸° */
      --canvas-h: 420px;
      --canvas-h-print: 320px;
    }

    body.font-large{
      --fs-body: 18px; --lh-body: 1.7;
      --fs-h1: 28px; --fs-sub: 16px;
      --fs-h2: 22px; --fs-hint: 16px;
      --fs-pill: 14px; --fs-q: 19px;

      --fs-input: 18px;
      --pad-input-y: 14px; --pad-input-x: 14px;
      --ta-minh: 110px;

      --fs-choice: 18px;
      --pad-choice-y: 12px; --pad-choice-x: 14px;
      --radio-size: 20px;

      --badge-size: 44px; --badge-radius: 12px; --badge-font: 20px;

      --token-font: 18px;
      --token-pad-y: 12px; --token-pad-x: 14px;

      --canvas-h: 520px;
      --canvas-h-print: 360px;
    }

    body.font-xlarge{
      --fs-body: 20px; --lh-body: 1.8;
      --fs-h1: 32px; --fs-sub: 17px;
      --fs-h2: 24px; --fs-hint: 17px;
      --fs-pill: 15px; --fs-q: 21px;

      --fs-input: 20px;
      --pad-input-y: 16px; --pad-input-x: 16px;
      --ta-minh: 125px;

      --fs-choice: 20px;
      --pad-choice-y: 14px; --pad-choice-x: 16px;
      --radio-size: 22px;

      --badge-size: 48px; --badge-radius: 14px; --badge-font: 22px;

      --token-font: 20px;
      --token-pad-y: 14px; --token-pad-x: 16px;

      --canvas-h: 620px;
      --canvas-h-print: 400px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",Arial,sans-serif;
      color:var(--ink);
      background:var(--bg);
      line-height:var(--lh-body);
      font-size:var(--fs-body);
    }
    header{
      background:#fff;
      border-bottom:1px solid var(--line);
      position:sticky; top:0; z-index:10;
    }
    .wrap{max-width:980px;margin:0 auto;padding:18px 16px 42px}
    header .wrap{padding:14px 16px}
    h1{font-size:var(--fs-h1);margin:0 0 6px}
    .sub{margin:0;color:var(--muted);font-size:var(--fs-sub)}
    .toolbar{display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin-top:10px}

    button{
      border:1px solid var(--line);
      background:#fff;
      border-radius:12px;
      padding:9px 12px;
      cursor:pointer;
      font-weight:800;
    }
    button:hover{border-color:#cbd5e1}

    .pill{
      font-size:var(--fs-pill);
      color:var(--muted);
      border:1px dashed var(--line);
      background:#fff;
      border-radius:999px;
      padding:7px 10px;
    }
    .seg{
      display:flex; gap:6px; flex-wrap:wrap; align-items:center;
      border:1px solid var(--line);
      border-radius:999px;
      padding:6px;
      background:#fff;
    }
    .seg button{
      border-radius:999px;
      padding:8px 10px;
      border:1px solid transparent;
      font-weight:900;
    }
    .seg button.active{
      border-color:#cbd5e1;
      background:#f8fafc;
    }

    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:18px;
      padding:16px;
      box-shadow:0 1px 0 rgba(0,0,0,.02);
      margin:14px 0;
    }
    .head{display:flex;gap:10px;align-items:flex-start;margin-bottom:10px}
    .badge{
      width:var(--badge-size);
      height:var(--badge-size);
      border-radius:var(--badge-radius);
      background:var(--ink);color:#fff;
      display:flex;align-items:center;justify-content:center;
      font-weight:900;
      font-size:var(--badge-font);
      flex:0 0 auto;
    }
    h2{font-size:var(--fs-h2);margin:0}
    .hint{margin:6px 0 0;color:var(--muted);font-size:var(--fs-hint)}

    .lineq{
      display:grid;
      grid-template-columns: 1fr;
      gap:8px;
      padding:10px 0;
      border-top:1px dashed var(--line);
    }
    .lineq:first-of-type{border-top:none}
    .qtext{font-weight:900; font-size:var(--fs-q)}
    .answers{display:flex;gap:10px;flex-wrap:wrap;align-items:center}

    .choice{
      display:flex;align-items:center;gap:10px;
      padding:var(--pad-choice-y) var(--pad-choice-x);
      border:1px solid var(--line);
      border-radius:16px;
      background:#fff;
      font-weight:800;
      font-size:var(--fs-choice);
    }
    .choice input{ width:var(--radio-size); height:var(--radio-size); }

    textarea,input[type="text"]{
      width:100%;
      border:1px solid var(--line);
      border-radius:12px;
      padding:var(--pad-input-y) var(--pad-input-x);
      font-size:var(--fs-input);
      background:#fff;
    }
    textarea{min-height:var(--ta-minh);resize:vertical}

    .keyline{
      background:var(--soft);
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px;
      margin-top:12px;
      font-weight:800;
    }
    .small{font-size:12px;color:var(--muted);margin:6px 0 0}

    /* í† í° ë¶„ë¥˜ */
    .tokens{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .token{
      user-select:none;
      padding:var(--token-pad-y) var(--token-pad-x);
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      font-weight:900;
      cursor:grab;
      font-size:var(--token-font);
    }
    .token:active{cursor:grabbing}
    .bins{display:grid;grid-template-columns:1fr;gap:12px;margin-top:10px}
    @media (min-width:760px){.bins{grid-template-columns:1fr 1fr}}
    .bin{
      border:2px dashed #cbd5e1;
      border-radius:16px;
      padding:10px;
      background:#fff;
      min-height:140px;
    }
    .bin h3{margin:0 0 4px;font-size:14px}
    .bin .bin-sub{margin:0;color:var(--muted);font-size:12px}
    .bin.over{border-color:#94a3b8;background:#f8fafc}
    #tokens.over{outline:2px dashed #94a3b8; outline-offset:6px; border-radius:16px}

    .actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .result{
      margin-top:10px;
      font-weight:900;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background:#fff;
    }

    /* ìº”ë²„ìŠ¤ */
    .bigbox{
      border:2px dashed #cbd5e1;
      border-radius:18px;
      padding:12px;
      background:#fff;
      margin-top:10px;
    }
    canvas{
      width:100%;
      height:var(--canvas-h);
      border:2px solid var(--line);
      border-radius:16px;
      display:block;
      background:#fff;
      touch-action:none;
    }
    .draw-tools{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-top:10px}

    /* ì—…ë¡œë“œ ë¯¸ë¦¬ë³´ê¸° */
    .preview{
      max-width:100%;
      display:none;
      border:2px solid var(--line);
      border-radius:16px;
    }

    /* ë¶™ì—¬ë„£ê¸°/ë“œë¡­ ë°•ìŠ¤ */
    .pastebox{
      margin-top:10px;
      border:2px dashed #cbd5e1;
      border-radius:16px;
      padding:14px 12px;
      background:#fff;
      font-weight:900;
      cursor:pointer;
      user-select:none;
    }
    .pastebox:focus{
      outline:3px solid #cbd5e1;
      outline-offset:2px;
    }
    .pastebox.over{
      border-color:#94a3b8;
      background:#f8fafc;
    }

    @media print{
      header{position:static}
      body{background:#fff}
      .toolbar, .no-print{display:none !important}
      .wrap{padding:0 10mm 10mm}
      canvas{height:var(--canvas-h-print)}
      button{display:none}

      .preview{display:none !important}
      .preview.has-src{display:block !important}
    }
  </style>
</head>

<body>
<header>
  <div class="wrap">
    <h1>ë§ˆì„ ì•ˆë‚´ë„ ë…ì„œí™œë™ í™œë™ì§€ (6ê°œ í™œë™)</h1>
    <p class="sub">í•µì‹¬ ê°œë…: <b>ì§€ë„ëŠ” ìœ„ì¹˜ë¥¼ ì•Œ ìˆ˜ ìˆë„ë¡ ì£¼ë³€ê³¼ì˜ ê´€ê³„ë¥¼ ìƒê°í•´ ê·¸ë¦° ì•½ì†</b>ì´ì—ìš”.</p>

    <div class="toolbar">
      <button type="button" onclick="window.print()">ì¸ì‡„í•˜ê¸°</button>
      <button type="button" onclick="resetAll()">ì „ì²´ ì´ˆê¸°í™”</button>

      <div class="seg no-print" aria-label="í° ê¸€ì”¨ ëª¨ë“œ">
        <button type="button" id="btnNormal" onclick="setFontMode('normal')">ë³´í†µ</button>
        <button type="button" id="btnLarge" onclick="setFontMode('large')">í° ê¸€ì”¨</button>
        <button type="button" id="btnXLarge" onclick="setFontMode('xlarge')">ì•„ì£¼ í¬ê²Œ</button>
      </div>

      <span class="pill">6ê°œ í™œë™ ìœ ì§€</span>
      <span class="pill">ê¸°í˜¸: ë‚´ê°€ ë§Œë“¤ê¸°</span>
      <span class="pill">ì—…ë¡œë“œ/ë¶™ì—¬ë„£ê¸°</span>
      <span class="pill">ê·¸ë¦¼ í¬ê²Œ(ë²„íŠ¼)</span>
    </div>
  </div>
</header>

<main class="wrap">

  <!-- 1 -->
  <section class="card" id="act1">
    <div class="head">
      <div class="badge">1</div>
      <div>
        <h2>ìƒê° ì—´ê¸°</h2>
        <p class="hint">â€œìœ„ì¹˜â€ë¥¼ ì•Œë ¤ì£¼ë ¤ë©´ ì£¼ë³€ì´ ì™œ í•„ìš”í• ê¹Œìš”?</p>
      </div>
    </div>

    <div class="lineq">
      <div class="qtext">1-1) ë†€ì´í„°ë§Œ ê·¸ë¦° ê·¸ë¦¼ì„ ì£¼ë©´ ì¹œêµ¬ê°€ ë†€ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ìˆì„ê¹Œìš”?</div>
      <div class="answers">
        <label class="choice"><input type="radio" name="a1_1" value="yes"> ì°¾ì„ ìˆ˜ ìˆì–´ìš”</label>
        <label class="choice"><input type="radio" name="a1_1" value="no"> ì°¾ê¸° ì–´ë ¤ì›Œìš”</label>
      </div>
      <textarea id="a1_why" placeholder="ì™œ ê·¸ë ‡ê²Œ ìƒê°í–ˆë‚˜ìš”? (ì•„ì´ ë§ ë°›ì•„ ì ê¸°)"></textarea>
    </div>

    <div class="keyline">ì •ë¦¬: ìœ„ì¹˜ë¥¼ ì•Œë ¤ì£¼ë ¤ë©´ <b>ì£¼ë³€ê³¼ì˜ ê´€ê³„(ì˜†ì—/ì•ì—/ê±´ë„ˆí¸/ë”°ë¼ê°€ë©´)</b>ê°€ í•„ìš”í•´ìš”.</div>
  </section>

  <!-- 2 -->
  <section class="card" id="act2">
    <div class="head">
      <div class="badge">2</div>
      <div>
        <h2>ì£¼ë³€ ê³ ë¥´ê¸°</h2>
        <p class="hint">ì°¾ê²Œ í•˜ë ¤ë©´ ë¬´ì—‡ì„ ê°™ì´ ê·¸ë¦¬ë©´ ì¢‹ì„ê¹Œìš”?</p>
      </div>
    </div>

    <div class="lineq">
      <div class="qtext">2-1) ë†€ì´í„°ë¥¼ ì°¾ê²Œ í•˜ë ¤ë©´ â€œê°™ì´ ê·¸ë¦¬ë©´ ì¢‹ì€ ê²ƒâ€ì— ì²´í¬í•´ìš”.</div>
      <div class="answers">
        <label class="choice"><input type="checkbox" name="a2_1" value="ì§‘"> ì§‘</label>
        <label class="choice"><input type="checkbox" name="a2_1" value="ê¸¸"> ê¸¸</label>
        <label class="choice"><input type="checkbox" name="a2_1" value="í•™êµ"> í•™êµ</label>
        <label class="choice"><input type="checkbox" name="a2_1" value="ë§ˆíŠ¸"> ë§ˆíŠ¸</label>
        <label class="choice"><input type="checkbox" name="a2_1" value="í•˜ëŠ˜"> í•˜ëŠ˜</label>
      </div>
      <textarea id="a2_talk" placeholder="í•œ ë¬¸ì¥ìœ¼ë¡œ ë§í•´ìš”. ì˜ˆ: â€˜ë†€ì´í„°ëŠ” í•™êµ ì˜†ì— ìˆì–´ìš”.â€™"></textarea>
    </div>
  </section>

  <!-- 3 -->
  <section class="card" id="act3">
    <div class="head">
      <div class="badge">3</div>
      <div>
        <h2>ë‚´ê°€ ë§Œë“œëŠ” ê¸°í˜¸(ë²”ë¡€) ë§Œë“¤ê¸°</h2>
        <p class="hint">ì •ë‹µ ë§íˆê¸° ëŒ€ì‹ , <b>ë‚´ê°€ ê¸°í˜¸ë¥¼ ë§Œë“¤ê³ </b> â€œì¢‹ì€ ê¸°í˜¸ë€?â€ì„ ìƒê°í•´ìš”.</p>
      </div>
    </div>

    <div class="lineq">
      <div class="qtext">3-1) ê¸°í˜¸ë¥¼ ë§Œë“¤ ëŒ€ìƒ 4ê°€ì§€ë¥¼ ê³ ë¥´ê³  ì ì–´ìš”.</div>
      <textarea id="sym_targets" placeholder="ì˜ˆ: ìš°ë¦¬ì§‘, í•™êµ, ë†€ì´í„°, ë§ˆíŠ¸"></textarea>
    </div>

    <div class="lineq">
      <div class="qtext">3-2) ì¢‹ì€ ê¸°í˜¸ëŠ” ì–´ë–¤ ê¸°í˜¸ì¼ê¹Œìš”? (ì²´í¬)</div>
      <div class="answers">
        <label class="choice"><input type="checkbox" name="sym_good" value="ê°„ë‹¨"> ê°„ë‹¨í•´ìš”</label>
        <label class="choice"><input type="checkbox" name="sym_good" value="êµ¬ë³„"> ë‹¤ë¥¸ ê¸°í˜¸ì™€ êµ¬ë³„ë¼ìš”</label>
        <label class="choice"><input type="checkbox" name="sym_good" value="ëœ»ì´ì§ì‘"> ëœ»ì´ ì§ì‘ë¼ìš”</label>
        <label class="choice"><input type="checkbox" name="sym_good" value="ì‘ì•„ë„ë³´ì„"> ì‘ê²Œ ê·¸ë ¤ë„ ë³´ì—¬ìš”</label>
      </div>
      <textarea id="sym_reason" placeholder="ì™œ ê·¸ë ‡ê²Œ ìƒê°í–ˆë‚˜ìš”? (ì§§ê²Œ)"></textarea>
    </div>

    <div class="lineq">
      <div class="qtext">3-3) ë‚´ê°€ ë§Œë“  ê¸°í˜¸(ë²”ë¡€)ë¥¼ ì ì–´ìš”. (ëŒ€ìƒ=ê¸°í˜¸)</div>
      <textarea id="legend" placeholder="ì˜ˆ: ğŸ =ìš°ë¦¬ì§‘, ğŸ’=í•™êµ, â­=ë†€ì´í„°, â– =ë§ˆíŠ¸"></textarea>
      <div class="small">íŒ: ê°™ì€ ëª¨ì–‘ì„ ì“°ë©´ í—·ê°ˆë ¤ìš”. ëª¨ì–‘/ìƒ‰(ë§ë¡œ)/íŒ¨í„´(ì ì„ )ìœ¼ë¡œ êµ¬ë³„í•´ë„ ì¢‹ì•„ìš”.</div>
    </div>

    <div class="lineq">
      <div class="qtext">3-4) í…ŒìŠ¤íŠ¸! ì¹œêµ¬ê°€ ë‚´ ë²”ë¡€ë¥¼ ë³´ê³  ë§í ìˆ˜ ìˆì„ê¹Œìš”?</div>
      <div class="answers">
        <label class="choice"><input type="radio" name="sym_test" value="yes"> ë„¤</label>
        <label class="choice"><input type="radio" name="sym_test" value="no"> ì•„ì§ ì–´ë ¤ì›Œìš”</label>
      </div>
      <textarea id="sym_fix" placeholder="ì–´ë ¤ì› ë‹¤ë©´ ë¬´ì—‡ì„ ê³ ì¹˜ë©´ ì¢‹ì„ê¹Œìš”? ì˜ˆ: ë” ë‹¨ìˆœí•˜ê²Œ / ë” ë‹¤ë¥´ê²Œ / ë” ë¹„ìŠ·í•˜ê²Œ"></textarea>
    </div>

    <div class="keyline">ì •ë¦¬: ê¸°í˜¸ëŠ” â€œê·¸ë¦¼â€ì´ ì•„ë‹ˆë¼ <b>ëœ»ì´ ì •í•´ì§„ ì•½ì†</b>ì´ì—ìš”. ë‚´ ê¸°í˜¸ê°€ ì•½ì†ì´ ë˜ë ¤ë©´ <b>ê°„ë‹¨ + êµ¬ë³„ + ì•Œì•„ë³´ê¸°</b>ê°€ ì¤‘ìš”í•´ìš”.</div>
  </section>

  <!-- 4 -->
  <section class="card" id="act4">
    <div class="head">
      <div class="badge">4</div>
      <div>
        <h2>í™˜ê²½ ë¶„ë¥˜</h2>
        <p class="hint">ë‹¨ì–´ í† í°ì„ ëŒì–´ ì˜®ê²¨ â€œìì—°í™˜ê²½ / ì¸ë¬¸í™˜ê²½â€ìœ¼ë¡œ ë‚˜ëˆ„ì–´ìš”.</p>
      </div>
    </div>

    <div class="lineq">
      <div class="qtext">4-1) ì•„ë˜ ë‹¨ì–´ë¥¼ â€œìì—°í™˜ê²½ / ì¸ë¬¸í™˜ê²½â€ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ë†“ì•„ìš”.</div>
      <div class="tokens" id="tokens">
        <span class="token" draggable="true" data-type="natural">ì‚°</span>
        <span class="token" draggable="true" data-type="natural">ê°•</span>
        <span class="token" draggable="true" data-type="natural">ë‚˜ë¬´</span>
        <span class="token" draggable="true" data-type="human">ì§‘</span>
        <span class="token" draggable="true" data-type="human">í•™êµ</span>
        <span class="token" draggable="true" data-type="human">ë„ë¡œ</span>
        <span class="token" draggable="true" data-type="human">ë†€ì´í„°</span>
      </div>

      <div class="bins">
        <div class="bin" id="binNatural" data-bin="natural">
          <h3>ğŸŒ³ ìì—°í™˜ê²½</h3>
          <p class="bin-sub">ì‚¬ëŒì´ ë§Œë“¤ì§€ ì•Šì€ ê²ƒ</p>
        </div>
        <div class="bin" id="binHuman" data-bin="human">
          <h3>ğŸ  ì¸ë¬¸í™˜ê²½</h3>
          <p class="bin-sub">ì‚¬ëŒì´ ë§Œë“  ê²ƒ</p>
        </div>
      </div>

      <div class="actions no-print">
        <button type="button" onclick="checkBins()">ë¶„ë¥˜ í™•ì¸</button>
        <button type="button" onclick="resetBins()">ë¶„ë¥˜ ì´ˆê¸°í™”</button>
      </div>
      <div id="binResult" class="result" aria-live="polite">ê²°ê³¼ê°€ ì—¬ê¸° í‘œì‹œë¼ìš”.</div>
    </div>
  </section>

  <!-- 5 -->
  <section class="card" id="act5">
    <div class="head">
      <div class="badge">5</div>
      <div>
        <h2>ìš°ë¦¬ ë™ë„¤ ê·¸ë¦¼ì§€ë„ ë§Œë“¤ê¸°</h2>
        <p class="hint">ì§ì ‘ ê·¸ë¦¬ê±°ë‚˜, ì¢…ì´ì— ê·¸ë¦° ë’¤ <b>ì—…ë¡œë“œ/ë¶™ì—¬ë„£ê¸°/ë“œë¡­</b>ë¡œ ì²¨ë¶€í•´ë„ ë¼ìš”.</p>
      </div>
    </div>

    <div class="lineq">
      <div class="qtext">5-0) ê·¸ë¦¼ ì²¨ë¶€(ì„ íƒ): ì—…ë¡œë“œ/ë¶™ì—¬ë„£ê¸°(Ctrl+V)/ë“œë˜ê·¸ì•¤ë“œë¡­</div>
      <div class="answers">
        <label class="choice">
          <input id="uploadMapImg" type="file" accept="image/*" />
          ê·¸ë¦¼/ì‚¬ì§„ ì—…ë¡œë“œ
        </label>
        <button type="button" class="no-print" onclick="clearUploadedImage()">ì²¨ë¶€ ì§€ìš°ê¸°</button>
      </div>

      <div style="margin-top:10px;">
        <img id="uploadPreview" class="preview" alt="ì²¨ë¶€í•œ ê·¸ë¦¼ ë¯¸ë¦¬ë³´ê¸°" />
        <div id="uploadHint" class="small" style="display:block;">ì²¨ë¶€í•œ ê·¸ë¦¼ì´ ì—¬ê¸° í‘œì‹œë¼ìš”.</div>

        <div id="pasteBox" class="pastebox no-print" tabindex="0" role="button" aria-label="ì—¬ê¸°ì— ê·¸ë¦¼ì„ ë¶™ì—¬ë„£ê¸°">
          ğŸ“‹ ì—¬ê¸°ë¥¼ í´ë¦­í•˜ê³  <b>Ctrl + V</b>ë¡œ ê·¸ë¦¼ì„ ë¶™ì—¬ë„£ê±°ë‚˜, íŒŒì¼ì„ ì—¬ê¸°ë¡œ ëŒì–´ë‹¤ ë†“ìœ¼ì„¸ìš”.
        </div>
        <div class="small no-print">â€» í´ë¦½ë³´ë“œì— â€œì´ë¯¸ì§€â€ê°€ ìˆì„ ë•Œë§Œ ë¶™ì—¬ë„£ê¸°ê°€ ë™ì‘í•´ìš”.</div>

        <div class="small">â€» í° ì‚¬ì§„ì€ ì €ì¥ì´ ì•ˆ ë  ìˆ˜ ìˆì–´ìš”(ë¸Œë¼ìš°ì € ìš©ëŸ‰ ì œí•œ). ë¯¸ë¦¬ë³´ê¸°ëŠ” ì •ìƒ ë™ì‘í•©ë‹ˆë‹¤.</div>
      </div>
    </div>

    <div class="lineq">
      <div class="qtext">5-1) ì§€ë„ì— ê¼­ ë„£ê¸°: ìš°ë¦¬ ì§‘ + ê¸¸ + ê¸°ì¤€(í•™êµ/ë†€ì´í„°/ë§ˆíŠ¸ ì¤‘ 1ê°œ) + ê´€ê³„(ì˜†/ì•/ê±´ë„ˆí¸)</div>
      <div class="bigbox">
        <canvas id="mapCanvas" aria-label="ìš°ë¦¬ ë™ë„¤ ê·¸ë¦¼ì§€ë„"></canvas>
        <div class="draw-tools no-print">
          <button type="button" onclick="setMode('draw')">ê·¸ë¦¬ê¸°</button>
          <button type="button" onclick="setMode('erase')">ì§€ìš°ê°œ</button>

          <label class="choice" style="margin:0">
            êµµê¸° <input type="range" id="penSize" min="2" max="24" value="6" />
          </label>

          <button type="button" onclick="resizeCanvasUI(120)">ê·¸ë¦¼ í¬ê²Œ</button>
          <button type="button" onclick="resizeCanvasUI(-120)">ê·¸ë¦¼ ì‘ê²Œ</button>

          <button type="button" onclick="clearCanvas()">ì „ì²´ ì§€ìš°ê¸°</button>
          <button type="button" onclick="saveCanvas()">ê·¸ë¦¼ ì €ì¥(ë¸Œë¼ìš°ì €)</button>
        </div>
        <div class="small">íŒ: ì˜ˆì˜ê²Œë³´ë‹¤ â€œì°¾ì„ ìˆ˜ ìˆê²Œâ€ê°€ ë” ì¤‘ìš”í•´ìš”.</div>
      </div>
    </div>

    <div class="keyline">ë‚´ ì§€ë„ì— ë²”ë¡€ê°€ ë“¤ì–´ê°”ë‚˜ìš”? (í™œë™ 3ì—ì„œ ë§Œë“  ê¸°í˜¸ë¥¼ ì‚¬ìš©í•´ìš”!)</div>
  </section>

  <!-- 6 -->
  <section class="card" id="act6">
    <div class="head">
      <div class="badge">6</div>
      <div>
        <h2>ì•ˆë‚´ë„ ì™„ì„± & ë§ˆë¬´ë¦¬</h2>
        <p class="hint">í•œëˆˆì— ë³´ì´ëŠ” â€œì•ˆë‚´ë„â€ + ë§ë¡œ ì„¤ëª…í•˜ëŠ” â€œì•ˆë‚´ì„œâ€ë¥¼ í•¨ê»˜ ë§Œë“¤ì–´ë´ìš”.</p>
      </div>
    </div>

    <div class="lineq">
      <div class="qtext">6-1) ì•ˆë‚´ì„œ í•œ ë¬¸ì¥ ì“°ê¸°: â€œìš°ë¦¬ ì§‘ì—ì„œ ê¸°ì¤€ ì¥ì†Œê¹Œì§€ ê°€ëŠ” ê¸¸â€</div>
      <textarea id="guideText" placeholder="ì˜ˆ: ìš°ë¦¬ ì§‘ì—ì„œ ë‚˜ì™€ì„œ ì˜¤ë¥¸ìª½ ê¸¸ë¡œ ì­‰ ê°€ìš”. í•™êµë¥¼ ì§€ë‚˜ë©´ ë†€ì´í„°ê°€ ë³´ì—¬ìš”."></textarea>
    </div>

    <div class="lineq">
      <div class="qtext">6-2) ë‚´ê°€ ë§Œë“  ê¸°í˜¸ë¥¼ ì¹œêµ¬ê°€ í—·ê°ˆë¦¬ì§€ ì•Šê²Œ í•˜ë ¤ë©´, ê°€ì¥ ì¤‘ìš”í•œ ì ì€?</div>
      <div class="answers">
        <label class="choice"><input type="radio" name="sym_key" value="ê°„ë‹¨"> ê°„ë‹¨í•˜ê²Œ</label>
        <label class="choice"><input type="radio" name="sym_key" value="êµ¬ë³„"> ì„œë¡œ ë‹¤ë¥´ê²Œ(êµ¬ë³„)</label>
        <label class="choice"><input type="radio" name="sym_key" value="ì§ì‘"> ëœ»ì´ ì§ì‘ë˜ê²Œ</label>
      </div>
      <textarea id="sym_key_why" placeholder="ì™œ ê·¸ë ‡ê²Œ ìƒê°í–ˆë‚˜ìš”?"></textarea>
    </div>

    <div class="lineq">
      <div class="qtext">6-3) ì˜¤ëŠ˜ì˜ í•œ ë¬¸ì¥: â€œì§€ë„ëŠ” ___ ì„(ë¥¼) ì•Œê¸° ìœ„í•´ ___ ì„(ë¥¼) í•¨ê»˜ ê·¸ë ¤ìš”.â€</div>
      <textarea id="oneLine" placeholder="ì˜ˆ: ì§€ë„ëŠ” â€˜ì–´ë””ì— ìˆëŠ”ì§€â€™ë¥¼ ì•Œê¸° ìœ„í•´ â€˜ì£¼ë³€â€™ì„ í•¨ê»˜ ê·¸ë ¤ìš”."></textarea>
    </div>

    <div class="lineq">
      <div class="qtext">6-4) ì˜¤ëŠ˜ í™œë™ ëŠë‚Œì€?</div>
      <div class="answers">
        <label class="choice"><input type="radio" name="feel" value="ğŸ˜€"> ğŸ˜€ ì¬ë¯¸ìˆì—ˆì–´</label>
        <label class="choice"><input type="radio" name="feel" value="ğŸ™‚"> ğŸ™‚ ê´œì°®ì•˜ì–´</label>
        <label class="choice"><input type="radio" name="feel" value="ğŸ˜•"> ğŸ˜• ì–´ë ¤ì› ì–´</label>
      </div>
    </div>

    <div class="keyline">
      ìµœì¢… í•µì‹¬: ì§€ë„ëŠ” ì„¸ìƒì„ ê·¸ëŒ€ë¡œ ë³µì‚¬í•œ ê²Œ ì•„ë‹ˆë¼ <b>ìœ„ì¹˜ë¥¼ ì•Œ ìˆ˜ ìˆê²Œ ì£¼ë³€ ê´€ê³„ë¥¼ ë‹´ì•„ í‘œí˜„í•œ ì•½ì†</b>ì´ì—ìš”.
    </div>
  </section>

</main>

<script>
  // =========================
  // í° ê¸€ì”¨ ëª¨ë“œ
  // =========================
  const FONT_KEY = "font_mode_v1";
  function setFontMode(mode){
    document.body.classList.remove("font-large","font-xlarge");
    if(mode === "large") document.body.classList.add("font-large");
    if(mode === "xlarge") document.body.classList.add("font-xlarge");
    try{ localStorage.setItem(FONT_KEY, mode); }catch(e){}
    syncFontButtons(mode);

    const saved = loadCanvas();
    fitCanvas();
    if(saved) restoreCanvas(saved);
  }
  function syncFontButtons(mode){
    const btnNormal = document.getElementById("btnNormal");
    const btnLarge = document.getElementById("btnLarge");
    const btnXLarge = document.getElementById("btnXLarge");
    [btnNormal,btnLarge,btnXLarge].forEach(b=> b && b.classList.remove("active"));
    if(mode === "large") btnLarge && btnLarge.classList.add("active");
    else if(mode === "xlarge") btnXLarge && btnXLarge.classList.add("active");
    else btnNormal && btnNormal.classList.add("active");
  }
  function loadFontMode(){
    try{ return localStorage.getItem(FONT_KEY) || "normal"; }catch(e){ return "normal"; }
  }

  // =========================
  // ìº”ë²„ìŠ¤ ë†’ì´ ì¡°ì ˆ + ì €ì¥
  // =========================
  const CANVAS_H_KEY = "canvas_height_v1";
  function resizeCanvasUI(delta){
    const root = document.documentElement;
    const current = parseInt(getComputedStyle(root).getPropertyValue("--canvas-h")) || 420;
    const next = Math.max(280, Math.min(900, current + delta));
    root.style.setProperty("--canvas-h", next + "px");
    try{ localStorage.setItem(CANVAS_H_KEY, String(next)); }catch(e){}

    const saved = loadCanvas();
    fitCanvas();
    if(saved) restoreCanvas(saved);
  }
  function applySavedCanvasHeight(){
    try{
      const savedH = parseInt(localStorage.getItem(CANVAS_H_KEY));
      if(savedH) document.documentElement.style.setProperty("--canvas-h", savedH + "px");
    }catch(e){}
  }

  // ---------------- Drag & Drop (Activity 4) ----------------
  const tokensArea = document.getElementById("tokens");
  const bins = [document.getElementById("binNatural"), document.getElementById("binHuman")];

  function handleDragStart(e){
    e.dataTransfer.setData("text/plain", e.target.dataset.type + "|" + e.target.textContent);
    e.dataTransfer.effectAllowed = "move";
    e.target.classList.add("dragging");
  }
  function handleDragEnd(e){ e.target.classList.remove("dragging"); }

  document.querySelectorAll(".token").forEach(t=>{
    t.addEventListener("dragstart", handleDragStart);
    t.addEventListener("dragend", handleDragEnd);
  });

  bins.forEach(bin=>{
    bin.addEventListener("dragover", (e)=>{ e.preventDefault(); bin.classList.add("over"); });
    bin.addEventListener("dragleave", ()=> bin.classList.remove("over"));
    bin.addEventListener("drop", (e)=>{
      e.preventDefault();
      bin.classList.remove("over");
      const dragging = document.querySelector(".token.dragging");
      if(dragging) bin.appendChild(dragging);
    });
  });

  tokensArea.addEventListener("dragover", (e)=>{ e.preventDefault(); tokensArea.classList.add("over"); });
  tokensArea.addEventListener("dragleave", ()=> tokensArea.classList.remove("over"));
  tokensArea.addEventListener("drop", (e)=>{
    e.preventDefault();
    tokensArea.classList.remove("over");
    const dragging = document.querySelector(".token.dragging");
    if(dragging) tokensArea.appendChild(dragging);
  });

  function checkBins(){
    let ok = true;
    bins.forEach(bin=>{
      const expected = bin.dataset.bin;
      bin.querySelectorAll(".token").forEach(t=>{
        if(t.dataset.type !== expected) ok = false;
      });
    });
    const r = document.getElementById("binResult");
    if(ok){
      r.textContent = "âœ… ë¶„ë¥˜ê°€ ì˜ ë˜ì—ˆì–´ìš”!";
      r.style.borderColor = "var(--ok)";
    } else {
      r.textContent = "ğŸ” ì¡°ê¸ˆ ì„ì˜€ì–´ìš”. â€˜ì‚¬ëŒì´ ë§Œë“  ê²ƒì¸ê°€?â€™ë¥¼ ìƒê°í•´ ë‹¤ì‹œ ì˜®ê²¨ìš”.";
      r.style.borderColor = "var(--warn)";
    }
  }
  function resetBins(){
    bins.forEach(bin=>{
      bin.querySelectorAll(".token").forEach(t=> tokensArea.appendChild(t));
    });
    const r = document.getElementById("binResult");
    r.textContent = "ê²°ê³¼ê°€ ì—¬ê¸° í‘œì‹œë¼ìš”.";
    r.style.borderColor = "var(--line)";
  }

  // ---------------- Canvas (Activity 5-1) ----------------
  const canvas = document.getElementById("mapCanvas");
  const ctx = canvas.getContext("2d");
  let drawing = false;
  let mode = "draw";

  function fitCanvas(){
    const rect = canvas.getBoundingClientRect();
    const dpr = window.devicePixelRatio || 1;
    canvas.width = Math.floor(rect.width * dpr);
    canvas.height = Math.floor(rect.height * dpr);
    ctx.setTransform(dpr,0,0,dpr,0,0);
    ctx.globalCompositeOperation = "source-over";
    ctx.fillStyle = "#ffffff";
    ctx.fillRect(0,0,rect.width,rect.height);
  }

  function setMode(m){ mode = m; }

  function pos(evt){
    const r = canvas.getBoundingClientRect();
    const e = evt.touches ? evt.touches[0] : evt;
    return { x: e.clientX - r.left, y: e.clientY - r.top };
  }

  function start(evt){
    drawing = true;
    const p = pos(evt);
    ctx.beginPath();
    ctx.moveTo(p.x, p.y);
    evt.preventDefault();
  }
  function move(evt){
    if(!drawing) return;
    const p = pos(evt);
    const size = Number(document.getElementById("penSize").value || 6);
    ctx.lineCap="round"; ctx.lineJoin="round"; ctx.lineWidth=size;

    if(mode === "erase"){
      ctx.globalCompositeOperation = "destination-out";
      ctx.strokeStyle = "rgba(0,0,0,1)";
    } else {
      ctx.globalCompositeOperation = "source-over";
      ctx.strokeStyle = "#111827";
    }
    ctx.lineTo(p.x,p.y);
    ctx.stroke();
    evt.preventDefault();
  }
  function end(evt){
    drawing = false;
    ctx.closePath();
    evt.preventDefault();
  }

  canvas.addEventListener("mousedown", start);
  canvas.addEventListener("mousemove", move);
  canvas.addEventListener("mouseup", end);
  canvas.addEventListener("mouseleave", end);
  canvas.addEventListener("touchstart", start, {passive:false});
  canvas.addEventListener("touchmove", move, {passive:false});
  canvas.addEventListener("touchend", end, {passive:false});
  canvas.addEventListener("touchcancel", end, {passive:false});

  function clearCanvas(){
    const r = canvas.getBoundingClientRect();
    ctx.save();
    ctx.globalCompositeOperation="source-over";
    ctx.fillStyle="#ffffff";
    ctx.fillRect(0,0,r.width,r.height);
    ctx.restore();
    saveCanvas();
  }

  function saveCanvas(){
    try{
      localStorage.setItem("mapCanvasData", canvas.toDataURL("image/png"));
      saveFormState();
    }catch(e){}
  }
  function loadCanvas(){
    try{ return localStorage.getItem("mapCanvasData"); }catch(e){ return null; }
  }
  function restoreCanvas(dataUrl){
    const img = new Image();
    img.onload = ()=>{
      const r = canvas.getBoundingClientRect();
      ctx.save();
      ctx.globalCompositeOperation="source-over";
      ctx.fillStyle = "#ffffff";
      ctx.fillRect(0,0,r.width,r.height);
      ctx.drawImage(img, 0, 0, r.width, r.height);
      ctx.restore();
    };
    img.src = dataUrl;
  }

  // ---------------- Upload + Paste Image (Activity 5-0) ----------------
  const uploadInput = document.getElementById("uploadMapImg");
  const previewImg  = document.getElementById("uploadPreview");
  const uploadHint  = document.getElementById("uploadHint");
  const pasteBox    = document.getElementById("pasteBox");
  const UPLOAD_KEY  = "act5_uploaded_image_v1";

  function fileToDataURL(file){
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onload = () => resolve(String(reader.result));
      reader.onerror = reject;
      reader.readAsDataURL(file);
    });
  }

  function showUploadedImage(dataUrl){
    if (!previewImg) return;
    previewImg.src = dataUrl;
    previewImg.style.display = "block";
    previewImg.classList.add("has-src");
    if (uploadHint) uploadHint.style.display = "none";
  }

  function clearUploadedImage(){
    if (uploadInput) uploadInput.value = "";
    if (previewImg){
      previewImg.src = "";
      previewImg.style.display = "none";
      previewImg.classList.remove("has-src");
    }
    if (uploadHint) uploadHint.style.display = "block";
    try { localStorage.removeItem(UPLOAD_KEY); } catch (e) {}
  }

  async function attachImageFile(file){
    if (!file) return;
    if (!file.type || !file.type.startsWith("image/")) {
      alert("ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì²¨ë¶€í•  ìˆ˜ ìˆì–´ìš”.");
      return;
    }
    const dataUrl = await fileToDataURL(file);
    showUploadedImage(dataUrl);
    try { localStorage.setItem(UPLOAD_KEY, dataUrl); }
    catch (err) { console.warn("ì´ë¯¸ì§€ ì €ì¥ ì‹¤íŒ¨(ìš©ëŸ‰ ì œí•œ ê°€ëŠ¥):", err); }
  }

  if (uploadInput) {
    uploadInput.addEventListener("change", async (e) => {
      const file = e.target.files && e.target.files[0];
      if (!file) return;
      await attachImageFile(file);
    });
  }

  document.addEventListener("paste", async (e) => {
    const items = e.clipboardData && e.clipboardData.items;
    if (!items) return;
    const imgItem = Array.from(items).find(it => it.type && it.type.startsWith("image/"));
    if (!imgItem) return;
    e.preventDefault();
    const file = imgItem.getAsFile();
    await attachImageFile(file);
  });

  if (pasteBox) {
    pasteBox.addEventListener("click", () => pasteBox.focus());
    pasteBox.addEventListener("dragover", (e)=>{ e.preventDefault(); pasteBox.classList.add("over"); });
    pasteBox.addEventListener("dragleave", ()=> pasteBox.classList.remove("over"));
    pasteBox.addEventListener("drop", async (e)=>{
      e.preventDefault();
      pasteBox.classList.remove("over");
      const file = e.dataTransfer && e.dataTransfer.files && e.dataTransfer.files[0];
      await attachImageFile(file);
    });
  }

  function restoreUploadedImage(){
    try{
      const saved = localStorage.getItem(UPLOAD_KEY);
      if (saved) showUploadedImage(saved);
    }catch(e){}
  }

  // ---------------- Form Save/Load ----------------
  const idsToSave = [
    "a1_why","a2_talk",
    "sym_targets","sym_reason","legend","sym_fix",
    "guideText","sym_key_why","oneLine"
  ];

  function saveFormState(){
    try{
      idsToSave.forEach(id=>{
        const el = document.getElementById(id);
        if(el) localStorage.setItem("f_"+id, el.value || "");
      });

      // radios
      const radios = Array.from(document.querySelectorAll('input[type="radio"]'));
      const names = [...new Set(radios.map(r=>r.name))];
      names.forEach(n=>{
        const checked = document.querySelector(`input[type="radio"][name="${n}"]:checked`);
        if(checked) localStorage.setItem("r_"+n, checked.value);
        else localStorage.removeItem("r_"+n);
      });

      // checkboxes: act2
      const cbs2 = Array.from(document.querySelectorAll('input[name="a2_1"]'));
      localStorage.setItem("cb_a2_1", cbs2.map(c=>c.checked?"1":"0").join(""));

      // checkboxes: sym_good
      const cbs3 = Array.from(document.querySelectorAll('input[name="sym_good"]'));
      localStorage.setItem("cb_sym_good", cbs3.map(c=>c.checked?"1":"0").join(""));
    }catch(e){}
  }

  function loadFormState(){
    try{
      idsToSave.forEach(id=>{
        const el = document.getElementById(id);
        const v = localStorage.getItem("f_"+id);
        if(el && v !== null) el.value = v;
      });

      // radios
      const radios = Array.from(document.querySelectorAll('input[type="radio"]'));
      const names = [...new Set(radios.map(r=>r.name))];
      names.forEach(n=>{
        const v = localStorage.getItem("r_"+n);
        if(v){
          const el = document.querySelector(`input[type="radio"][name="${n}"][value="${CSS.escape(v)}"]`);
          if(el) el.checked = true;
        }
      });

      // checkboxes: act2
      const cb2 = localStorage.getItem("cb_a2_1");
      if(cb2){
        const cbs = Array.from(document.querySelectorAll('input[name="a2_1"]'));
        cbs.forEach((c,i)=> c.checked = (cb2[i] === "1"));
      }

      // checkboxes: sym_good
      const cb3 = localStorage.getItem("cb_sym_good");
      if(cb3){
        const cbs = Array.from(document.querySelectorAll('input[name="sym_good"]'));
        cbs.forEach((c,i)=> c.checked = (cb3[i] === "1"));
      }
    }catch(e){}
  }

  document.addEventListener("input", (e)=>{
    if(e.target.matches("textarea,input,select")) saveFormState();
  });
  document.addEventListener("change", (e)=>{
    if(e.target.matches("textarea,input,select")) saveFormState();
  });

  // ---------------- Reset All ----------------
  function resetAll(){
    document.querySelectorAll('input[type="radio"],input[type="checkbox"]').forEach(el=> el.checked=false);
    document.querySelectorAll('input[type="text"],textarea').forEach(el=> el.value="");

    resetBins();
    clearCanvas();
    clearUploadedImage();

    try{
      Object.keys(localStorage).forEach(k=>{
        if(
          k.startsWith("f_") || k.startsWith("r_") || k.startsWith("cb_") ||
          k==="mapCanvasData" || k===UPLOAD_KEY
        ){
          localStorage.removeItem(k);
        }
      });
      localStorage.removeItem(CANVAS_H_KEY);
    }catch(e){}

    mode = "draw";
    const pen = document.getElementById("penSize");
    if(pen) pen.value = 6;

    document.documentElement.style.removeProperty("--canvas-h");
    fitCanvas();
  }

  // ---------------- Init ----------------
  setTimeout(()=>{
    const mode = loadFontMode();
    setFontMode(mode);

    applySavedCanvasHeight();
    restoreUploadedImage();

    fitCanvas();
    loadFormState();

    const saved = loadCanvas();
    if(saved) restoreCanvas(saved);
  }, 0);

  window.addEventListener("resize", ()=>{
    const saved = loadCanvas();
    fitCanvas();
    if(saved) restoreCanvas(saved);
  });
</script>
</body>
</html>
